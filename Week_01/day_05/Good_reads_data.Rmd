---
title: "R Notebook"
output: html_notebook
---
```{r}
library(tidyverse)
library(CodeClanData)
```

```{r}
Good_reads <- read_csv('data/books.csv')

Good_reads
```

```{r}
head(Good_reads)

tail(Good_reads)

dim(Good_reads)

glimpse(Good_reads)

names(Good_reads)

head(Good_reads)

sum(is.na(Good_reads))
```

```{r}
book_subset <- Good_reads %>% 
  select(authors, title, ratings_count, text_reviews_count, language_code, publisher, bookID)
```

```{r}
Good_reads %>% 
  select(authors, title, ratings_count, text_reviews_count, language_code, publisher) %>% 
  filter(is.na(authors)) %>% 
  summarise(count_of_missing_authors = n())
```
Q1
```{r}
Highest_average_rating <- Good_reads %>% 
  select(title, average_rating, bookID) %>%
  group_by(average_rating) %>% 
  summarise(mean_rating = mean(average_rating)) %>% 
  arrange(desc(mean_rating)) %>% 
  head(5) %>% 
  pull()

Highest_average_rating
```
Q2
```{r}
most_reviews <- Good_reads %>% 
  select(title, text_reviews_count, bookID) %>% 
  arrange(desc(text_reviews_count)) %>% 
  head(1) 
  

most_reviews
```
Q3
```{r}
most_ratings <- Good_reads %>% 
  select(title, ratings_count, bookID) %>% 
  arrange(desc(ratings_count)) %>% 
  head(1)

most_ratings
```

```{r}
least_ratings <- Good_reads %>% 
  select(title, ratings_count, bookID) %>% 
  arrange(ratings_count) %>% 
  head(1)

least_ratings
```
Q4
```{r}
highest_rating_publisher <- Good_reads %>% 
  select(publisher, average_rating) %>% 
  group_by(publisher) %>% 
  summarise(mean_ratings = mean(average_rating)) %>% 
  arrange(desc(mean_ratings)) %>% 
  head(1)


highest_rating_publisher
```

```{r}
#highest_rating_median_publisher <- Good_reads %>% 
  #select(publisher, average_rating) %>% 
  #group_by(publisher) %>% 
  #summarise(median_ratings = median(average_rating)) %>% 
  #arrange(desc(median_ratings)) %>% 
  #head(1)


#highest_rating_median_publisher
```

```{r}
Highest_page_count <- Good_reads %>% 
  select(language_code, num_pages) %>% 
  summarise(num_pages, language_code) %>% 
  arrange(desc(Highest_page_count))


Highest_page_count
```

```{r}
Highest_language_code <- Good_reads %>% 
  select(language_code, average_rating) %>% 
  summarise(max(average_rating)) 

Highest_language_code  
```
Q5
```{r}
Longest_language_Code <- Good_reads %>% 
  select(language_code, num_pages) %>% 
  group_by(language_code) %>% 
  summarise(longest_books = max(num_pages)) 
  #pull()

```
Q6
```{r}
Highest_book_rating <- Good_reads %>% 
  select(language_code, average_rating) %>% 
  group_by(language_code) %>% 
  summarise(Highest_rating = max(average_rating)) #%>% 
  #pull()

Highest_book_rating
```

```{r}
Good_reads
```

```{r}
Earliest_releases <- Good_reads %>% 
  select(publisher, title, publication_date) %>% 
  group_by(publisher) %>% 
  arrange(publication_date) %>% 
  head(10)
  
Earliest_releases
```

```{r}
Latest_release <- Good_reads %>% 
  select(publisher, title, bookID, publication_date) %>% 
  group_by(publisher, publication_date) %>% 
  arrange(desc(publication_date)) %>% 
  head(10)

Latest_release
```

```{r}
Author_avg_rating <- Good_reads %>% 
  select(authors, average_rating, ratings_count) %>% 
  group_by(authors) %>% 
  mutate(avg_authors_rating = mean(average_rating)) %>% 
  arrange(desc(avg_authors_rating)) %>% 
  head(20)


Author_avg_rating
```

```{r}

longest_books <- Good_reads %>% 
  slice_min(num_pages, n = 15)

shortest_books <- Good_reads %>% 
  slice_max(runtime, n = 10)
```

